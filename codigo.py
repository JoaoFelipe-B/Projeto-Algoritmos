arestas = [
    # Acre
    [4, 1, 7.8],
    [4, 2, 9],
    [2, 3, 620.5],
    [1, 3, 615],

    # Alagoas
    [7, 5, 38.4],
    [7, 8, 155],
    [5, 6, 266],
    [8, 6, 357],

    # Amapá
    [9, 12, 437],
    [9, 11, 1.6],
    [11, 10, 297.1],
    [12, 10, 272],

    # Amazonas
    [13, 16, 17],
    [13, 15, 303],
    [15, 14, 379.2],
    [16, 14, 660.7],

    # Bahia
    [17, 20, 1.7],
    [17, 19, 268],
    [19, 18, 1673],
    [20, 18, 1829],

    # Ceará
    [21, 24, 2.3],
    [21, 23, 86.6],
    [23, 22, 99.1],
    [24, 22, 32.2],

    # Espírito Santo
    [25, 28, 59.5],
    [25, 26, 92.1],
    [26, 27, 147],
    [28, 27, 223],

    # Goiás
    [32, 30, 63.2],
    [32, 31, 541],
    [31, 29, 160],
    [30, 29, 422],

    # Maranhão
    [35, 33, 248],
    [35, 34, 760],
    [34, 36, 182.2],
    [33, 36, 605],

    # Mato Grosso
    [39, 40, 98.8],
    [39, 37, 66.5],
    [37, 38, 270],
    [38, 40, 374.8],

    # Mato Grosso do Sulva
    [41, 44, 277],
    [41, 42, 281],
    [42, 43, 16.6],
    [43, 44, 43.6],

    # Minas Gerais
    [45, 47, 341],
    [45, 46, 48.6],
    [46, 48, 138],
    [47, 48, 431],

    # Paraíba
    [51, 52, 100],
    [51, 49, 9.1],
    [52, 50, 117],
    [49, 50, 128],

    # Paraná
    [55, 56, 79.1],
    [55, 53, 119],
    [56, 54, 144],
    [53, 54, 69.8],

    # Pernambuco
    [57, 58, 9.7],
    [57, 60, 61.2],
    [58, 59, 144],
    [60, 59, 162],

    # Piauí
    [62, 64, 18],
    [62, 63, 11],
    [64, 61, 334],
    [63, 61, 313],

    # Rio de Janeiro
    [67, 68, 6],
    [67, 65, 9.5],
    [68, 66, 13.5],
    [65, 66, 6.2],

    # Rio Grande do Norte
    [70, 69, 61, 2],
    [70, 71, 59, 2],
    [69, 72, 162],
    [71, 72, 140],

    # Rio Grande do Sul
    [74, 75, 15.8],
    [74, 73, 106],
    [75, 76, 407],
    [73, 76, 308],

    # Rondônia
    [79, 77, 363],
    [79, 78, 241],
    [77, 80, 551],
    [78, 80, 726],

    # Roraíma
    [83, 81, 0.3],
    [83, 84, 49.8],
    [81, 82, 83.7],
    [84, 82, 114],

    # Santa Catarina
    [87, 85, 11.4],
    [87, 88, 3.6],
    [85, 86, 110],
    [88, 86, 123],

    # São Paulo
    [91, 89, 81.2],
    [91, 92, 74.6],
    [89, 90, 42.9],
    [92, 90, 51.5],

    # Sergipe
    [94, 93, 7.9],
    [94, 96, 7.7],
    [93, 95, 218],
    [96, 95, 220],

    # Tocatins
    [100, 98, 111],
    [100, 99, 27.2],
    [98, 97, 240],
    [99, 97, 274],

    # Pará
    [102, 101, 219],
    [102, 103, 305],
    [101, 104, 1188],
    [103, 104, 1292],

    # Nordeste
    [57, 49, 115],
    [57, 33, 1500],
    [57, 61, 1111],
    [57, 17, 798],
    [57, 69, 285],
    [57, 21, 744],
    [57, 93, 490],
    [57, 5, 248],
    [33, 61, 429],
    [33, 21, 806],
    [33, 69, 1289],
    [33, 49, 1415],
    [33, 5, 1527],
    [33, 93, 1462],
    [33, 17, 1565],
    [61, 21, 570],
    [61, 69, 964],
    [61, 49, 1066],
    [61, 5, 1102],
    [61, 93, 1037],
    [61, 17, 1138],
    [21, 69, 509],
    [21, 49, 636],
    [21, 5, 878],
    [21, 93, 982],
    [21, 17, 1136],
    [69, 49, 177],
    [69, 5, 531],
    [69, 93, 714],
    [69, 17, 1019],
    [5, 93, 242],
    [5, 17, 556],
    [5, 49, 361],
    [49, 17, 893],
    [49, 93, 587],
    [17, 93, 316],

    # Suldeste
    [89, 65, 451],
    [89, 45, 580],
    [89, 25, 885],
    [65, 45, 447],
    [65, 25, 543],
    [25, 45, 511],

    # Norte
    [13, 101, 2984],
    [13, 1, 1395],
    [13, 77, 888],
    [13, 81, 738],
    [13, 9, 2982],
    [13, 97, 2924],
    [101, 1, 2999],
    [101, 77, 2492],
    [101, 81, 222],
    [101, 9, 5963],
    [101, 97, 1129],
    [1, 77, 508],
    [1, 81, 2130],
    [1, 9, 4374],
    [1, 97, 2796],
    [77, 81, 1623],
    [77, 9, 3867],
    [77, 97, 2290],
    [81, 9, 2262],
    [81, 97, 3659],
    [9, 97, 3658],

    # Centro-Oeste
    [37, 41, 781],
    [37, 29, 885],
    [41, 29, 827],

    # Sul
    [73, 85, 474],
    [73, 53, 683],
    [53, 85, 302],

    # Inter-Regionais
    [57, 89, 2572],
    [57, 13, 4571],
    [57, 29, 2171],
    [57, 73, 3651],
    [13, 29, 3027],
    [13, 89, 3849],
    [13, 73, 4420],
    [89, 29, 939],
    [89, 73, 1079],
    [29, 73, 1791]
]


class Grafo:
    def __init__(self, vertice):  # cria uma lista vazia
        self.V = vertice
        self.grafo = []

    def add_aresta(self, u, v, w):  # método para adicionar arestas ponderadas no grafo
        self.grafo.append([u, v, w])

    def busca(self, pai, i):  # Faz uma busca recursiva para retornar o 'i'
        if pai[i] == i:
            return i
        return self.busca(pai, pai[i])

    def conectar(self, pai, rank, x, y):  # conecta as raizes
        raiz_x = self.busca(pai, x)
        raiz_y = self.busca(pai, y)
        if rank[raiz_x] < rank[raiz_y]:
            pai[raiz_x] = raiz_y
        elif rank[raiz_x] > rank[raiz_y]:
            pai[raiz_y] = raiz_x
        else:
            pai[raiz_y] = raiz_x
            rank[raiz_x] += 1

    # Esse algoritmo vai ordenar uma lista de arestas pelo seu peso e inicializa pai e rank matrizes
    # Em seguida, ele itera sobre a lista ordenada de arestas, seleciona-as uma a uma e as adiciona à árvore resultante.
    # O algoritmo para quando o número de arestas da árvore resultante é igual a (self.V – 1).
    # A árvore resultante é a árvore geradora mínima que estamos tentando construir e o peso da soma das arestas

    def kruskal(self):
        total = 0
        arestas = 0
        result = []
        i = 0
        e = 0

        self.grafo = sorted(self.grafo, key=lambda item: item[2])
        pai = []
        rank = []
        for no in range(self.V):
            pai.append(no)
            rank.append(0)
        while e < self.V - 1:
            s, d, p = self.grafo[i]
            i = i + 1
            x = self.busca(pai, s)
            y = self.busca(pai, d)
            if x != y:
                e = e + 1
                result.append([s, d, p])
                self.conectar(pai, rank, x, y)
        print(f"a1    a2    peso")
        print('================')
        for s, d, peso in result:
            arestas += 1
            print(f'{s:^3} {d:^7}', end=" ")
            print(f"\33[31m{peso:^4}\33[m")
            total += peso

        print()
        print(f"Para construir a Árvore Geradora Mínima, foram usadas {arestas} arestas")
        print(f'O peso da árvore geradora mínima é de \33[31m{total}')


# Esse laço é meramente para conciliar com o algoritmo
for a in arestas:
    a[0] -= 1
    a[1] -= 1

grafo = Grafo(104)  # Instância de Grafo

# Esse laço adiciona as arestas ao grafo "grafo"
for a in arestas:
    grafo.add_aresta(a[0], a[1], a[2])

# Kruskal é aplicado e nos é retornado as arestas da Árvore Geradora Mínima e a soma dos pesos das arestas
grafo.kruskal()
